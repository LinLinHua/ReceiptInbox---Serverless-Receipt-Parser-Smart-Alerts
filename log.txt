Creating output directory...
Running training script...
Loading data...
Loaded training samples: 4978
Loaded testing samples: 893

Preprocessing data for logistic regression...
Preprocessing: Converting tokens to strings for TF-IDF...
Extracting TF-IDF features...
TF-IDF Matrix Shape (Train): (4978, 722)
Preprocessing TF-IDF data completed...
Training Logistic Regression Baseline...
Evaluating model...

========================================
 BASELINE RESULTS (Logistic Regression)
========================================
Accuracy: 0.8656
Macro F1: 0.2734
----------------------------------------

Classification Report:
                   precision    recall  f1-score   support

     abbreviation       1.00      0.79      0.88        33
         aircraft       0.43      1.00      0.60         9
          airfare       0.87      0.85      0.86        48
   airfare+flight       0.00      0.00      0.00         1
          airline       1.00      0.76      0.87        38
          airport       1.00      0.11      0.20        18
         capacity       1.00      0.10      0.17        21
             city       0.00      0.00      0.00         6
         day_name       0.00      0.00      0.00         2
         distance       0.00      0.00      0.00        10
           flight       0.86      1.00      0.92       632
   flight+airfare       0.00      0.00      0.00        12
   flight+airline       0.00      0.00      0.00         1
        flight_no       0.00      0.00      0.00         8
flight_no+airline       0.00      0.00      0.00         1
      flight_time       0.00      0.00      0.00         1
      ground_fare       0.00      0.00      0.00         7
   ground_service       0.95      0.97      0.96        36
             meal       0.00      0.00      0.00         6
         quantity       0.00      0.00      0.00         3

         accuracy                           0.87       893
        macro avg       0.36      0.28      0.27       893
     weighted avg       0.82      0.87      0.82       893

Saving model artifacts to ../output/models...
Model and Vectorizer saved successfully.
Generating learning curve for Logistic_Regression's Learning Curve...
Learning curve generated.
Learning curve saved to ../output/figures/logistic_regression_LR.png
Generating Confusion Matrix...
Confusion Matrix saved to ../output/figures/baseline_confusion_matrix.png

Preprocessing data for LSTM...
Built vocabularies: 632
--- Training Dataset Data Length Statistics ---
Total samples: 4978
Max Length:    46
Min Length:    1
Avg Length:    11.37
95th %ile:     19.0 
99th %ile:     25.229999999999563
----------------------------------------
Token padding length: 19
Number of classes (intents): 26

Using device: mps

========================================
 EXPERIMENT 3A: LSTM 
========================================

Starting training for 30 epochs...
Epoch: 01 | Train Loss: 1.426 | Val Loss: 1.404 | Val Acc: 0.708 | Val Macro F1: 0.041
Epoch: 02 | Train Loss: 1.149 | Val Loss: 1.382 | Val Acc: 0.707 | Val Macro F1: 0.043
Epoch: 03 | Train Loss: 1.120 | Val Loss: 1.280 | Val Acc: 0.736 | Val Macro F1: 0.069
Epoch: 04 | Train Loss: 0.926 | Val Loss: 0.931 | Val Acc: 0.795 | Val Macro F1: 0.128
Epoch: 05 | Train Loss: 0.632 | Val Loss: 0.800 | Val Acc: 0.820 | Val Macro F1: 0.152
Epoch: 06 | Train Loss: 0.496 | Val Loss: 0.717 | Val Acc: 0.843 | Val Macro F1: 0.187
Epoch: 07 | Train Loss: 0.406 | Val Loss: 0.570 | Val Acc: 0.861 | Val Macro F1: 0.197
Epoch: 08 | Train Loss: 0.357 | Val Loss: 0.546 | Val Acc: 0.872 | Val Macro F1: 0.253
Epoch: 09 | Train Loss: 0.296 | Val Loss: 0.450 | Val Acc: 0.879 | Val Macro F1: 0.280
Epoch: 10 | Train Loss: 0.247 | Val Loss: 0.496 | Val Acc: 0.881 | Val Macro F1: 0.293
Epoch: 11 | Train Loss: 0.218 | Val Loss: 0.487 | Val Acc: 0.905 | Val Macro F1: 0.411
Epoch: 12 | Train Loss: 0.193 | Val Loss: 0.363 | Val Acc: 0.919 | Val Macro F1: 0.484
Epoch: 13 | Train Loss: 0.157 | Val Loss: 0.384 | Val Acc: 0.909 | Val Macro F1: 0.424
Epoch: 14 | Train Loss: 0.151 | Val Loss: 0.359 | Val Acc: 0.929 | Val Macro F1: 0.499
Epoch: 15 | Train Loss: 0.137 | Val Loss: 0.343 | Val Acc: 0.931 | Val Macro F1: 0.486
Epoch: 16 | Train Loss: 0.122 | Val Loss: 0.302 | Val Acc: 0.936 | Val Macro F1: 0.518
Epoch: 17 | Train Loss: 0.106 | Val Loss: 0.291 | Val Acc: 0.934 | Val Macro F1: 0.502
Epoch: 18 | Train Loss: 0.099 | Val Loss: 0.293 | Val Acc: 0.932 | Val Macro F1: 0.505
Epoch: 19 | Train Loss: 0.081 | Val Loss: 0.272 | Val Acc: 0.942 | Val Macro F1: 0.549
Epoch: 20 | Train Loss: 0.089 | Val Loss: 0.291 | Val Acc: 0.944 | Val Macro F1: 0.574
Epoch: 21 | Train Loss: 0.078 | Val Loss: 0.281 | Val Acc: 0.948 | Val Macro F1: 0.572
Epoch: 22 | Train Loss: 0.070 | Val Loss: 0.259 | Val Acc: 0.954 | Val Macro F1: 0.607
Epoch: 23 | Train Loss: 0.065 | Val Loss: 0.287 | Val Acc: 0.945 | Val Macro F1: 0.622
Epoch: 24 | Train Loss: 0.059 | Val Loss: 0.328 | Val Acc: 0.946 | Val Macro F1: 0.585
Epoch: 25 | Train Loss: 0.055 | Val Loss: 0.285 | Val Acc: 0.951 | Val Macro F1: 0.600
Epoch: 26 | Train Loss: 0.053 | Val Loss: 0.284 | Val Acc: 0.955 | Val Macro F1: 0.625
Epoch: 27 | Train Loss: 0.044 | Val Loss: 0.323 | Val Acc: 0.947 | Val Macro F1: 0.617
Epoch: 28 | Train Loss: 0.049 | Val Loss: 0.284 | Val Acc: 0.952 | Val Macro F1: 0.613
Epoch: 29 | Train Loss: 0.059 | Val Loss: 0.272 | Val Acc: 0.959 | Val Macro F1: 0.668
Epoch: 30 | Train Loss: 0.046 | Val Loss: 0.284 | Val Acc: 0.956 | Val Macro F1: 0.622
Model saved to ../output/models/lstm_model.pt

Learning curve saved to ../output/figures/lstm_learning_curve.png
Confusion Matrix saved to ../output/figures/lstm_cm.png


========================================
 EXPERIMENT 3B: LSTM+GloVe 
========================================
Loading GloVe embeddings from ../data/glove.6B.100d.txt...
Found 628 relevant word vectors in GloVe.
Converted 628 words (99.4%) from GloVe. Missed 4 words.

Starting training for 30 epochs...
Epoch: 01 | Train Loss: 1.314 | Val Loss: 1.406 | Val Acc: 0.708 | Val Macro F1: 0.041
Epoch: 02 | Train Loss: 1.079 | Val Loss: 1.090 | Val Acc: 0.735 | Val Macro F1: 0.060
Epoch: 03 | Train Loss: 0.767 | Val Loss: 0.909 | Val Acc: 0.761 | Val Macro F1: 0.094
Epoch: 04 | Train Loss: 0.633 | Val Loss: 0.789 | Val Acc: 0.820 | Val Macro F1: 0.156
Epoch: 05 | Train Loss: 0.488 | Val Loss: 0.652 | Val Acc: 0.863 | Val Macro F1: 0.201
Epoch: 06 | Train Loss: 0.400 | Val Loss: 0.598 | Val Acc: 0.861 | Val Macro F1: 0.200
Epoch: 07 | Train Loss: 0.354 | Val Loss: 0.478 | Val Acc: 0.873 | Val Macro F1: 0.228
Epoch: 08 | Train Loss: 0.301 | Val Loss: 0.467 | Val Acc: 0.878 | Val Macro F1: 0.237
Epoch: 09 | Train Loss: 0.276 | Val Loss: 0.408 | Val Acc: 0.888 | Val Macro F1: 0.317
Epoch: 10 | Train Loss: 0.218 | Val Loss: 0.366 | Val Acc: 0.920 | Val Macro F1: 0.413
Epoch: 11 | Train Loss: 0.199 | Val Loss: 0.351 | Val Acc: 0.918 | Val Macro F1: 0.419
Epoch: 12 | Train Loss: 0.165 | Val Loss: 0.292 | Val Acc: 0.926 | Val Macro F1: 0.452
Epoch: 13 | Train Loss: 0.146 | Val Loss: 0.320 | Val Acc: 0.923 | Val Macro F1: 0.472
Epoch: 14 | Train Loss: 0.134 | Val Loss: 0.311 | Val Acc: 0.915 | Val Macro F1: 0.444
Epoch: 15 | Train Loss: 0.137 | Val Loss: 0.281 | Val Acc: 0.927 | Val Macro F1: 0.490
Epoch: 16 | Train Loss: 0.110 | Val Loss: 0.260 | Val Acc: 0.952 | Val Macro F1: 0.573
Epoch: 17 | Train Loss: 0.111 | Val Loss: 0.273 | Val Acc: 0.948 | Val Macro F1: 0.544
Epoch: 18 | Train Loss: 0.092 | Val Loss: 0.246 | Val Acc: 0.959 | Val Macro F1: 0.605
Epoch: 19 | Train Loss: 0.093 | Val Loss: 0.251 | Val Acc: 0.943 | Val Macro F1: 0.534
Epoch: 20 | Train Loss: 0.086 | Val Loss: 0.243 | Val Acc: 0.962 | Val Macro F1: 0.644
Epoch: 21 | Train Loss: 0.082 | Val Loss: 0.206 | Val Acc: 0.959 | Val Macro F1: 0.583
Epoch: 22 | Train Loss: 0.079 | Val Loss: 0.232 | Val Acc: 0.965 | Val Macro F1: 0.662
Epoch: 23 | Train Loss: 0.059 | Val Loss: 0.232 | Val Acc: 0.955 | Val Macro F1: 0.592
Epoch: 24 | Train Loss: 0.070 | Val Loss: 0.239 | Val Acc: 0.963 | Val Macro F1: 0.637
Epoch: 25 | Train Loss: 0.064 | Val Loss: 0.221 | Val Acc: 0.966 | Val Macro F1: 0.652
Epoch: 26 | Train Loss: 0.062 | Val Loss: 0.231 | Val Acc: 0.963 | Val Macro F1: 0.652
Epoch: 27 | Train Loss: 0.063 | Val Loss: 0.251 | Val Acc: 0.965 | Val Macro F1: 0.638
Epoch: 28 | Train Loss: 0.056 | Val Loss: 0.208 | Val Acc: 0.970 | Val Macro F1: 0.686
Epoch: 29 | Train Loss: 0.049 | Val Loss: 0.211 | Val Acc: 0.971 | Val Macro F1: 0.705
Epoch: 30 | Train Loss: 0.046 | Val Loss: 0.244 | Val Acc: 0.964 | Val Macro F1: 0.665
Model saved to ../output/models/lstmGloVe_model.pt

Learning curve saved to ../output/figures/lstmGloVe_learning_curve.png
Confusion Matrix saved to ../output/figures/lstmGloVe_cm.png


========================================
 EXPERIMENT 4: LSTM+GloVe HYPERPARAMETERS TUNING 
========================================
Loading GloVe embeddings from ../data/glove.6B.100d.txt...
Found 628 relevant word vectors in GloVe.
Converted 628 words (99.4%) from GloVe. Missed 4 words.

Starting training for 30 epochs...
Epoch: 01 | Train Loss: 1.249 | Val Loss: 1.415 | Val Acc: 0.708 | Val Macro F1: 0.041
Epoch: 02 | Train Loss: 0.921 | Val Loss: 0.973 | Val Acc: 0.761 | Val Macro F1: 0.086
Epoch: 03 | Train Loss: 0.612 | Val Loss: 0.800 | Val Acc: 0.775 | Val Macro F1: 0.096
Epoch: 04 | Train Loss: 0.487 | Val Loss: 0.696 | Val Acc: 0.845 | Val Macro F1: 0.199
Epoch: 05 | Train Loss: 0.345 | Val Loss: 0.565 | Val Acc: 0.879 | Val Macro F1: 0.240
Epoch: 06 | Train Loss: 0.269 | Val Loss: 0.479 | Val Acc: 0.884 | Val Macro F1: 0.247
Epoch: 07 | Train Loss: 0.218 | Val Loss: 0.355 | Val Acc: 0.907 | Val Macro F1: 0.347
Epoch: 08 | Train Loss: 0.175 | Val Loss: 0.333 | Val Acc: 0.919 | Val Macro F1: 0.411
Epoch: 09 | Train Loss: 0.147 | Val Loss: 0.314 | Val Acc: 0.929 | Val Macro F1: 0.473
Epoch: 10 | Train Loss: 0.116 | Val Loss: 0.289 | Val Acc: 0.951 | Val Macro F1: 0.592
Epoch: 11 | Train Loss: 0.107 | Val Loss: 0.273 | Val Acc: 0.959 | Val Macro F1: 0.651
Epoch: 12 | Train Loss: 0.093 | Val Loss: 0.239 | Val Acc: 0.963 | Val Macro F1: 0.647
Epoch: 13 | Train Loss: 0.077 | Val Loss: 0.241 | Val Acc: 0.964 | Val Macro F1: 0.609
Epoch: 14 | Train Loss: 0.071 | Val Loss: 0.208 | Val Acc: 0.966 | Val Macro F1: 0.638
Epoch: 15 | Train Loss: 0.063 | Val Loss: 0.225 | Val Acc: 0.966 | Val Macro F1: 0.658
Epoch: 16 | Train Loss: 0.066 | Val Loss: 0.242 | Val Acc: 0.962 | Val Macro F1: 0.630
Epoch: 17 | Train Loss: 0.063 | Val Loss: 0.251 | Val Acc: 0.965 | Val Macro F1: 0.641
Epoch: 18 | Train Loss: 0.053 | Val Loss: 0.233 | Val Acc: 0.966 | Val Macro F1: 0.678
Epoch: 19 | Train Loss: 0.047 | Val Loss: 0.239 | Val Acc: 0.971 | Val Macro F1: 0.643
Epoch: 20 | Train Loss: 0.054 | Val Loss: 0.222 | Val Acc: 0.968 | Val Macro F1: 0.642
Epoch: 21 | Train Loss: 0.041 | Val Loss: 0.229 | Val Acc: 0.970 | Val Macro F1: 0.693
Epoch: 22 | Train Loss: 0.034 | Val Loss: 0.238 | Val Acc: 0.969 | Val Macro F1: 0.698
Epoch: 23 | Train Loss: 0.035 | Val Loss: 0.240 | Val Acc: 0.970 | Val Macro F1: 0.678
Epoch: 24 | Train Loss: 0.030 | Val Loss: 0.239 | Val Acc: 0.971 | Val Macro F1: 0.699
Epoch: 25 | Train Loss: 0.033 | Val Loss: 0.237 | Val Acc: 0.973 | Val Macro F1: 0.714
Epoch: 26 | Train Loss: 0.028 | Val Loss: 0.241 | Val Acc: 0.974 | Val Macro F1: 0.722
Epoch: 27 | Train Loss: 0.025 | Val Loss: 0.241 | Val Acc: 0.974 | Val Macro F1: 0.722
Epoch: 28 | Train Loss: 0.026 | Val Loss: 0.241 | Val Acc: 0.974 | Val Macro F1: 0.722
Epoch: 29 | Train Loss: 0.027 | Val Loss: 0.240 | Val Acc: 0.974 | Val Macro F1: 0.722
Epoch: 30 | Train Loss: 0.027 | Val Loss: 0.240 | Val Acc: 0.974 | Val Macro F1: 0.722
Model saved to ../output/models/lstmGloVe_model_opt.pt

Learning curve saved to ../output/figures/lstmGloVe_learning_curve_opt.png
Confusion Matrix saved to ../output/figures/lstmGloVe_cm_opt.png
